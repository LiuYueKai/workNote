## 前端工程说明
## 表一：流水线-id-node服务-开发分支-cdn

| 工程                     | 线上域名      | 流水线                                                  | 流水线id | node服务 | 开发分支                          |
| ------------------------ | ------------- | ------------------------------------------------------- | -------- | -------- | --------------------------------- |
| ucf-staff-fe             | staff | iuap5-staff-fe                                          | pkpulvc1 | 是       | ucfbasedoc                        |
| ucf-org-fe               | org           | iuap5-org-fe                                            | s0byu1mo | 是       | develop                           |
| ucf-userdef-fe           | bd-ext        | iuap5-userdef-fe                                        | atsecnsg | 是       | ucf-basedoc-fe工程的userdef_daily |
| ucf-basedoc-fe           | basedoc       | iuap5-basedoc-fe                                        | dge8ngu1 | 是       | ucfbasedoc                        |
| bPaaS_eventCenter_fe     | ms            | 旧：ys-event-fe；新：iuap5-event-fe                     | qzr8skaq | 否       |                                   |
| diwork-log-fe            | ms            | 旧：ys-log-fe；新：iuap5-log-fe                         | gh349u61 | 否       |                                   |
| cloud-os_fe              | workbench     | 旧：u8c3-diwork-fe-pages；新：iuap5-diwork-fe-pages     | v59k029k | 否       |  u8c-release              |
| cloud-os_manager_fe      | workbech      | 旧：u8c3-diwork-fe-manager；新：iuap5-diwork-fe-manager | xhx4r693 | 否       |    develop                 |
| bPaaS_billcode_fe        | ms            | 旧：u8c-billcode-fe；新：iuap5-billcode-fe              | mkvfej6j | 否       |                                   |
| bPaaS_dispatch_fe        | ms            | iuap5-bpaas-dispatch-fe                                 | odc5hm6v | 否       |                                   |
| bPaaS_prewarning_fe      | ms            | 旧：prewarning-fe；新：iuap5-prewarning-fe              | a1mrr8vx | 否       |                                   |
| iuap-message-platform-fe | message       | iuap5-message-platform-fe                               | emw2uwcr | 否       |                                   |
| bPaaS_international_fe   | ms            | iuap5-bpaas-international-fe                            | shxw6gi0 | 否       |                                   |
| UStock-web               | auth | iuap5-auth-web                                          | r8xxc6uy | 是       ||
| UStock-web-yxy               | upc | iuap5-upc-web                                          | fpk1ft5c | 是       ||
| iuap-basedate-fe               | mc | maven被后端依赖                                          |  | 否       |                                   |
| yonyou-mdf-manage | tpl| iuap5-yonyou-mdf-manage | g9kbryyv | 是 | |
| ucf-mdf-design | | iuap5-ucf-mdf-design | tqigxqgr | 是 | develop |
| fc_omc_fe| fin-fe| iuap5-omc-fe| f9mp4vyq| 是 | |
| metadata-front| | iuap5-metadata-fe| n2p1rg9q| 是 |u8c |
| iuap-message-fe| | iuap5-message-fe| qjkz9xkw| 是 | |
| iuap5-isearch-fe| | iuap5-isearch-fe| iii9gfd7| 是 | |
| iuap5-intelliv-fe | |iuap5-intelliv-fe|ysp49i7n |是||


## 表二：工程 - 地址 - 节点 - 构建


| 工程                     | 地址                                                         | 节点                                                   | 构建 |
| ------------------------ | ------------------------------------------------------------ | ------------------------------------------------------ | ---- |
| ucf-staff-fe  | [yan_group2/ucf-staff-fe](http://git.yonyou.com/yan_group2/ucf-staff-fe)                | 职等、职级、职务、职位、职务类别、员工类别、员工       | 本地 |
| ucf-org-fe   | [yan_group2/ucf-org-fe](http://git.yonyou.com/yan_group2/ucf-org-fe)                  | 多组织、组织单元、部门、职能共享、采购、销售、核算     | 本地 |
| Ucf-userdef-fe | [iuap_ap/ucf-userdef-fe](http://git.yonyou.com/iuap_ap/ucf-userdef-fe)                 | 自定义项                                               | 本地 |
| ucf-basedoc-fe | [iuap_ap/ucf-basedoc-fe](http://git.yonyou.com/iuap_ap/ucf-basedoc-fe)                 | 公共档案(基础档案)、自定义档案维护                             | 本地 |
| bPaaS_eventCenter_fe | [iuap_ap/bPaaS_eventCenter_fe](http://git.yonyou.com/iuap_ap/bPaaS_eventCenter_fe)           | 事件中心                                               |      |
| Diwork-log-fe | [iuap_ap/bPaaS_diworkLog_fe](http://git.yonyou.com/iuap_ap/bPaaS_diworkLog_fe)             | 日志管理                                               | 本地 |
| cloud-os_fe              | [iuap_ap/cloud-os_fe](http://git.yonyou.com/iuap_ap/cloud-os_fe)                    | diwork框架工程                                         | 本地 |
| cloud-os_manager_fe | [iuap_ap/cloud-os_manager_fe](http://git.yonyou.com/iuap_ap/cloud-os_manager_fe)            | 系统管理：应用管理                                    | 本地 |
| bPaaS_billcode_fe | [iuap_ap/bPaaS_billcode_fe](http://git.yonyou.com/iuap_ap/bPaaS_billcode_fe)              | 编码规则                                               | 本地 |
| bPaaS_dispatch_fe | [iuap_ap/bPaaS_dispatch_fe](http://git.yonyou.com/iuap_ap/bPaaS_dispatch_fe)              | 调度任务                                               | 本地 |
| bPaaS_prewarning_fe | [iuap_ap/bPaaS_prewarning_fe](http://git.yonyou.com/iuap_ap/bPaaS_prewarning_fe)            | 预警任务                                               | 本地 |
| iuap-message-platform-fe | [iuap-message-platform/iuap-message-platform-fe](http://git.yonyou.com/iuap-message-platform/iuap-message-platform-fe) | 消息平台                                               | 本地 |
| bPaaS_international_fe | [iuap_ap/bPaaS_international_fe](http://git.yonyou.com/iuap_ap/bPaaS_international_fe)         | 格式定义                                               |      |
| UStock-web    | [ap_exclusive_baseapp/Ustock-web](http://git.yonyou.com/ap_exclusive_baseapp/Ustock-web)        | 角色管理、授权、公共参数| 本地 |
| UStock-web-yxy  | [ap_exclusive_baseapp/Ustock-web-yxy](http://git.yonyou.com/ap_exclusive_baseapp/Ustock-web-yxy)        | 三大档案(物料、客户、供应商) | 本地 |
| Iuap-basedate-fe | [iuap_ap/iuap-basedate-fe](http://git.yonyou.com/iuap_ap/iuap-basedate-fe)               | 基础数据分级管理                                       |      |
| yonyou-mdf-manage | [yonyou-mdf/yonyou-mdf-manage](http://git.yonyou.com/yonyou-mdf/yonyou-mdf-manage)           | UI模板                                             |      |
| ucf-mdf-design | [yonyou-mdf/ucf-mdf-design](http://git.yonyou.com/yonyou-mdf/ucf-mdf-design)              | UI模板设计器                                            |  |
| fc_omc_fe | [ap_exclusive_fe/fc_omc_fe](http://git.yonyou.com/ap_exclusive_fe/fc_omc_fe)              | 财务                                               | 本地 |
| Metadata-front | [iuap_ap/metadata-front](http://git.yonyou.com/iuap_ap/metadata-front)              | 元数据                                              |      |
| iuap-message-fe | [ap_exclusive_fe/iuap-message-fe](http://git.yonyou.com/ap_exclusive_fe/iuap-message-fe)              | 消息中心                                              |      |
| iuap5-isearch-fe |直接上传构建产物              | 智能查询                                              |      |
| iuap5-intelliv-fe |直接上传构建产物 | 报表平台 | |

分支名称为：5.0-on-premises-dev

注：http://git.yonyou.com/wanghaooo/bPaaS_warning_fe develop (将dist目录文件移入bPaaS_dispatch_fe)

## 环境信息

### 开发环境

https://u8c-daily.yyuap.com/#/  账号： 18600574329 / yonyou@1988  19556888888 test0729

u8c-test.yyuap.com u8c_vip@163.com yonyou@1988

http://workbench.dev-on-premises.yyuap.com/#/   账号：19487888888 test0704

### 演示环境

http://workbench.demo01-on-premises.yyuap.com/    账号：19487888888   test0704

在线访问url:

**事件中心**：http://ms.dev-on-premises.yyuap.com/event-center/#/

**格式定义**：http://ms.dev-on-premises.yyuap.com/international-fe/#/

## cloud-os_fe

### 本地产出
* 修改nodemodules
	`sed -i 's/return hosts\[key\]\[process.env.NODE_ENV\]/const hosts1 = {     api: "",     workbench: "${pom.workbench.domain}",     u8c: "${pom.workbench.domain}",     yzone: "undefined-yzone",     u8cportal: "undefined-u8cportal",     manageTeamEnter: "undefined-manageTeamEnter",     login: "${pom.sso.domain}",     euc: "${user.url}", 		user: "${pom.user.domain}",     market: "undefined-market",     upload: "undefined-upload",     info: "undefined-info",     speak: "undefined-speak",     honor: "undefined-honor",     sendHonor: "undefined-sendHonor",     ticket: "undefined-ticket",     order: "undefined-order",     cloundyy: "undefined-cloundyy",     ref: "${pom.ms.domain}",     org: "${pom.org.domain}",     paramsetting: "undefined-paramsetting",     platform: "undefined-platform",     developerPath: "undefined-developerPath",     orderSearch: "undefined-orderSearch", 		tenantauth: "${pom.tenantauth.domain}", 		ms: "${pom.ms.domain}", 		bd: "${pom.bd.domain}", 		sso: "${pom.sso.domain}", 		manager: "${pom.manager.domain}", 		isearch: "${pom.isearch.domain}", 		message: "${pom.message.domain}", 		fastdfs: "${pom.fastdfs.domain}", 		staff: "${pom.staff.domain}", 		basedoc: "${pom.basedoc.domain}", 		mc: "${pom.mc.domain}", 		bdext: "${pom.bd-ext.domain}", 		upc: "${pom.upc.domain}", 		auth: "${pom.auth.domain}" 	}; 	return hosts1\[key\]/g' node_modules/@diworkfe/public-components/build/utils.js`
* 替换src下的专属化变量
	sed -i ''  "s/window\._IUAPPREMISESFLAG/true/g" `grep window._IUAPPREMISESFLAG -rl src`
* 产出命令

`npm run premises && npm run premises_copy`

**执行完毕要将src下的修改还原**

## cloud-os_manager_fe

### 本地产出
* 修改nodemodules
	``sed -i 's/return hosts\[key\]\[process.env.NODE_ENV\]/const hosts1 = {     api: "",     workbench: "${pom.workbench.domain}",     u8c: "${pom.workbench.domain}",     yzone: "undefined-yzone",     u8cportal: "undefined-u8cportal",     manageTeamEnter: "undefined-manageTeamEnter",     login: "${pom.sso.domain}",     euc: "${user.url}", 		user: "${pom.user.domain}",     market: "undefined-market",     upload: "undefined-upload",     info: "undefined-info",     speak: "undefined-speak",     honor: "undefined-honor",     sendHonor: "undefined-sendHonor",     ticket: "undefined-ticket",     order: "undefined-order",     cloundyy: "undefined-cloundyy",     ref: "${pom.ms.domain}",     org: "${pom.org.domain}",     paramsetting: "undefined-paramsetting",     platform: "undefined-platform",     developerPath: "undefined-developerPath",     orderSearch: "undefined-orderSearch", 		tenantauth: "${pom.tenantauth.domain}", 		ms: "${pom.ms.domain}", 		bd: "${pom.bd.domain}", 		sso: "${pom.sso.domain}", 		manager: "${pom.manager.domain}", 		isearch: "${pom.isearch.domain}", 		message: "${pom.message.domain}", 		fastdfs: "${pom.fastdfs.domain}", 		staff: "${pom.staff.domain}", 		basedoc: "${pom.basedoc.domain}", 		mc: "${pom.mc.domain}", 		bdext: "${pom.bd-ext.domain}", 		upc: "${pom.upc.domain}", 		auth: "${pom.auth.domain}" 	}; 	return hosts1\[key\]/g' node_modules/@diworkfe/public-components/build/utils.js``
* 替换src下的专属化变量
	sed -i ''  "s/window\._IUAPPREMISESFLAG/true/g" `grep window._IUAPPREMISESFLAG -rl src`
* 产出命令

`npm run premises && npm run premises_copy`
**执行完毕要将src下的修改还原**

##  ucf-staff-fe

###  部署

本地开发：debug:server   debug:client     

### 本地产出
`npm run build:premises`


##  ucf-org-fe

###  部署

本地开发：debug:server   debug:client     
### 本地产出
`npm run build:premises`


## ucf-basedoc-fe
### 本地产出
`npm run build:premises`

## ucf-userdef-fe
### 本地产出
`npm run build:premises`

## fc_omc_fe
### 本地产出
`npm run build:dll && npm run build`

## bPaaS_dispatch_fe
### 本地产出
* `npm run build:premises`
* 在dist下的manifest.js，第一行添加 window.$$messagedomain = '${pom.message.domain}';
* 将dist下的"https://u8cmsg-daily.yyuap.com替换为  window.$$messagedomain + "
* 在dist下执行tar -zcvf  iuap5-bpaas-dispatch-fe.zip ./



## bPaaS_billcode_fe
### 本地产出
`npm run build && npm run build:map && npm run premises`

## bPaaS_prewarning_fe
### 本地产出
* `npm run build:premises`
* 在dist下的manifest.js，第一行添加 window.$$messagedomain = '${pom.message.domain}';
* 将dist下的"https://u8cmsg-daily.yyuap.com替换为  window.$$messagedomain + "
* 在dist下执行tar -zcvf  iuap5-prewarning-fe.zip ./

## iuap-message-platform-fe

### 本地产出
* 替换src下的专属化变量
	sed -i ''  "s/window\._IUAPPREMISESFLAG/true/g" `grep window._IUAPPREMISESFLAG -rl src`
* `npm run build:premises`

## iuap-message-fe

### 本地产出
`npm run build`

## bPaaS_diworkLog_fe

### 本地产出

* 替换src下的专属化变量
	sed -i ''  "s/window\._IUAPPREMISESFLAG/true/g" `grep window._IUAPPREMISESFLAG -rl src`
* 产出命令

`npm run build`

## yonyou-mdf-manage

### 本地产出

* 产出命令

`npm run build:premises`

## Ustock-web

### 本地产出

* 更新yxyweb（第一次需要更新，没必要每次都更新）
在目录 /UPC-Web/src下执行
```
rm -rf  yxyweb*
git clone  -b u8cdev  http://git.yonyou.com/yxyframework/yxyweb.git
```
*  产出命令
```
npm run auth && node premises/cdn.js
```
* 替换命令
前两个只需要替换一次，最后一个需要每次都执行
```
sed -i '' 's@http://127.0.0.1:8000@${pom.org.permission.url}@g' pm2.json 
sed -i '' 's@3006@${NODEJS.PORT}@g' pm2.json 
sed -i '' 's@https://u8cms-daily.yyuap.com@${pom.ms.domain}@g' static/public/javascripts/index.min.js 
```

## UStock-web-yxy

### 本地产出

* 更新yxyweb（第一次需要更新，没必要每次都更新）
在目录 /UPC-Web/src下执行
```
rm -rf  yxyweb*
git clone  -b u8cdev  http://git.yonyou.com/yxyframework/yxyweb.git
```
*  产出命令
```
npm run  build && node premises/cdn.js
```
* 替换命令
只需要替换一次
```
sed -i '' 's@http://127.0.0.1:8000@${pom.upc.domain}@g' pm2.json 
sed -i '' 's@3006@${NODEJS.PORT}@g' pm2.json 
```